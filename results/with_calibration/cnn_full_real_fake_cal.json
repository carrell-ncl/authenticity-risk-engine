"""
Model Evaluation Summary

This system was evaluated on a balanced dataset of 4,000 audio clips (2,000 real, 2,000 fake).
Each audio file was processed into 6 × 4-second segments, scored by a CNN spoof-detection model, and aggregated using the median segment score.

Two configurations were evaluated:

CNN-only (raw spoof signal)

CNN + feature-based calibration layer (logistic regression over aggregated features)

CNN-Only Model (Baseline Signal)

AUC: 0.829

Strengths: High fake detection rate, strong ranking ability

Limitations: Elevated false-positive rate on real audio

At a representative operating point (threshold = 0.5):

Fake accuracy: 94.5%

Real accuracy: 56.2%

Overall accuracy: 75.3%

Precision: 68.3%

Top-K review performance (ranking use case):

Reviewing 10% of highest-risk clips captures 17.6% of all fake audio

Reviewed set purity ≈ 88% fake

This confirms the CNN provides a strong raw spoof signal, suitable for downstream calibration and risk ranking.

Calibrated Model (Production Configuration)

The calibrated model uses aggregated CNN signals and audio-level features:

cnn_median, cnn_max, cnn_var

total_seconds, silence_ratio

AUC: 0.894

Key improvement: Substantially better balance between real and fake classification

At the recommended operating point (threshold = 0.5):

Fake accuracy: 84.9%

Real accuracy: 77.9%

Overall accuracy: 81.5%

Precision: 79.4%

Top-K review performance:

Reviewing 10% of highest-risk clips captures 18.8% of all fake audio

Reviewed set purity ≈ 94% fake

Reviewing 20% captures 36.8% of all fake audio

"""
{
  "data_dir": "data/audio/processed/real_or_fake",
  "n_total": 4000,
  "n_real": 2000,
  "n_fake": 2000,
  "clip_seconds": 4.0,
  "n_segments": 6,
  "cnn_agg": "median",
  "thresholds": [
    0.3,
    0.5,
    0.7,
    0.85
  ],
  "cnn_only": {
    "auc": 0.82879,
    "threshold_metrics": [
      {
        "threshold": 0.3,
        "real_accuracy": 0.4975,
        "fake_accuracy": 0.976,
        "overall_accuracy": 0.73675,
        "overall_precision": 0.6601285086236051,
        "confusion_matrix": [
          [
            995,
            1005
          ],
          [
            48,
            1952
          ]
        ],
        "confusion_matrix_labels": [
          "real",
          "fake"
        ]
      },
      {
        "threshold": 0.5,
        "real_accuracy": 0.562,
        "fake_accuracy": 0.9445,
        "overall_accuracy": 0.75325,
        "overall_precision": 0.6831826401446655,
        "confusion_matrix": [
          [
            1124,
            876
          ],
          [
            111,
            1889
          ]
        ],
        "confusion_matrix_labels": [
          "real",
          "fake"
        ]
      },
      {
        "threshold": 0.7,
        "real_accuracy": 0.6215,
        "fake_accuracy": 0.8885,
        "overall_accuracy": 0.755,
        "overall_precision": 0.7012628255722179,
        "confusion_matrix": [
          [
            1243,
            757
          ],
          [
            223,
            1777
          ]
        ],
        "confusion_matrix_labels": [
          "real",
          "fake"
        ]
      },
      {
        "threshold": 0.85,
        "real_accuracy": 0.6885,
        "fake_accuracy": 0.8025,
        "overall_accuracy": 0.7455,
        "overall_precision": 0.7203770197486535,
        "confusion_matrix": [
          [
            1377,
            623
          ],
          [
            395,
            1605
          ]
        ],
        "confusion_matrix_labels": [
          "real",
          "fake"
        ]
      }
    ],
    "topk_metrics": [
      {
        "review_frac": 0.05,
        "n_total": 4000,
        "n_review": 200,
        "fake_total": 2000,
        "fake_caught": 179,
        "fake_catch_rate": 0.0895,
        "reviewed_fake_rate": 0.895
      },
      {
        "review_frac": 0.1,
        "n_total": 4000,
        "n_review": 400,
        "fake_total": 2000,
        "fake_caught": 351,
        "fake_catch_rate": 0.1755,
        "reviewed_fake_rate": 0.8775
      },
      {
        "review_frac": 0.2,
        "n_total": 4000,
        "n_review": 800,
        "fake_total": 2000,
        "fake_caught": 660,
        "fake_catch_rate": 0.33,
        "reviewed_fake_rate": 0.825
      }
    ]
  },
  "calibrated": {
    "calibrator_path": "models/calibrators/agg_lr_real_or_fake_new.joblib",
    "feature_names": [
      "cnn_median",
      "cnn_max",
      "cnn_var",
      "total_seconds",
      "silence_ratio"
    ],
    "auc": 0.8936014999999999,
    "threshold_metrics": [
      {
        "threshold": 0.3,
        "real_accuracy": 0.6455,
        "fake_accuracy": 0.942,
        "overall_accuracy": 0.79375,
        "overall_precision": 0.7265715387581951,
        "confusion_matrix": [
          [
            1291,
            709
          ],
          [
            116,
            1884
          ]
        ],
        "confusion_matrix_labels": [
          "real",
          "fake"
        ]
      },
      {
        "threshold": 0.5,
        "real_accuracy": 0.7795,
        "fake_accuracy": 0.8495,
        "overall_accuracy": 0.8145,
        "overall_precision": 0.7939252336448598,
        "confusion_matrix": [
          [
            1559,
            441
          ],
          [
            301,
            1699
          ]
        ],
        "confusion_matrix_labels": [
          "real",
          "fake"
        ]
      },
      {
        "threshold": 0.7,
        "real_accuracy": 0.891,
        "fake_accuracy": 0.6775,
        "overall_accuracy": 0.78425,
        "overall_precision": 0.8614113159567705,
        "confusion_matrix": [
          [
            1782,
            218
          ],
          [
            645,
            1355
          ]
        ],
        "confusion_matrix_labels": [
          "real",
          "fake"
        ]
      },
      {
        "threshold": 0.85,
        "real_accuracy": 0.96,
        "fake_accuracy": 0.405,
        "overall_accuracy": 0.6825,
        "overall_precision": 0.9101123595505618,
        "confusion_matrix": [
          [
            1920,
            80
          ],
          [
            1190,
            810
          ]
        ],
        "confusion_matrix_labels": [
          "real",
          "fake"
        ]
      }
    ],
    "topk_metrics": [
      {
        "review_frac": 0.05,
        "n_total": 4000,
        "n_review": 200,
        "fake_total": 2000,
        "fake_caught": 188,
        "fake_catch_rate": 0.094,
        "reviewed_fake_rate": 0.94
      },
      {
        "review_frac": 0.1,
        "n_total": 4000,
        "n_review": 400,
        "fake_total": 2000,
        "fake_caught": 375,
        "fake_catch_rate": 0.1875,
        "reviewed_fake_rate": 0.9375
      },
      {
        "review_frac": 0.2,
        "n_total": 4000,
        "n_review": 800,
        "fake_total": 2000,
        "fake_caught": 735,
        "fake_catch_rate": 0.3675,
        "reviewed_fake_rate": 0.91875
      }
    ]
  }
}